<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Specificity plot — specificity_plot • cellGeometry</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Specificity plot — specificity_plot"><meta name="description" content="Scatter plot showing specificity of genes as markers for a particular cell
subclass. Optimal gene markers for that cell subclass are those genes which
are closest to or lie on the y axis, while also being of highest mean
expression."><meta property="og:description" content="Scatter plot showing specificity of genes as markers for a particular cell
subclass. Optimal gene markers for that cell subclass are those genes which
are closest to or lie on the y axis, while also being of highest mean
expression."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">cellGeometry</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.5.8</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/intro.html">Get Started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/algorithm.html">Mathematical Foundations</a></li>
    <li><a class="dropdown-item" href="../articles/visualization.html">Visualization Guide</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/index.html">All articles</a></li>
  </ul></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-tutorials" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Tutorials</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-tutorials"><li><a class="dropdown-item" href="../articles/intro.html">Quick Start Guide</a></li>
    <li><a class="dropdown-item" href="../articles/real_world.html">Real-World Application</a></li>
    <li><a class="dropdown-item" href="../articles/brain_atlas.html">Large-Scale: Brain Atlas</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/Zaoqu-Liu/cellGeometry"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Specificity plot</h1>
      <small class="dont-index">Source: <a href="https://github.com/Zaoqu-Liu/cellGeometry/blob/HEAD/R/specificity_plot.R" class="external-link"><code>R/specificity_plot.R</code></a></small>
      <div class="d-none name"><code>specificity_plot.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Scatter plot showing specificity of genes as markers for a particular cell
subclass. Optimal gene markers for that cell subclass are those genes which
are closest to or lie on the y axis, while also being of highest mean
expression.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">specificity_plot</span><span class="op">(</span></span>
<span>  <span class="va">mk</span>,</span>
<span>  subclass <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  group <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  type <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  use_filter <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  nrank <span class="op">=</span> <span class="fl">8</span>,</span>
<span>  nsubclass <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  expfilter <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  scheme <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  add_labels <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  label_pos <span class="op">=</span> <span class="st">"right"</span>,</span>
<span>  axis_extend <span class="op">=</span> <span class="fl">0.4</span>,</span>
<span>  nudge_x <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  nudge_y <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">specificity_plotly</span><span class="op">(</span></span>
<span>  <span class="va">mk</span>,</span>
<span>  subclass <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  group <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  type <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  use_filter <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  nrank <span class="op">=</span> <span class="fl">8</span>,</span>
<span>  nsubclass <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  expfilter <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  scheme <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-mk">mk<a class="anchor" aria-label="anchor" href="#arg-mk"></a></dt>
<dd><p>a 'cellMarkers' class object.</p></dd>


<dt id="arg-subclass">subclass<a class="anchor" aria-label="anchor" href="#arg-subclass"></a></dt>
<dd><p>character value specifying the subclass to be plotted.</p></dd>


<dt id="arg-group">group<a class="anchor" aria-label="anchor" href="#arg-group"></a></dt>
<dd><p>character value specifying cell group to be plotted. One of
<code>subclass</code> or <code>group</code> must be specified.</p></dd>


<dt id="arg-type">type<a class="anchor" aria-label="anchor" href="#arg-type"></a></dt>
<dd><p>Numeric value, either 1 (the default) for a plot of angle on x
axis and mean expression on y axis; or 2 for a plot projecting the vector
angle into the same plain. See Details below.</p></dd>


<dt id="arg-use-filter">use_filter<a class="anchor" aria-label="anchor" href="#arg-use-filter"></a></dt>
<dd><p>logical, whether to use gene mean expression to which
noise reduction filtering has been applied.</p></dd>


<dt id="arg-nrank">nrank<a class="anchor" aria-label="anchor" href="#arg-nrank"></a></dt>
<dd><p>number of ranks of subclasses to display.</p></dd>


<dt id="arg-nsubclass">nsubclass<a class="anchor" aria-label="anchor" href="#arg-nsubclass"></a></dt>
<dd><p>numeric value, number of top markers to label. By default
this is obtained from <code>mk</code> for that subclass.</p></dd>


<dt id="arg-expfilter">expfilter<a class="anchor" aria-label="anchor" href="#arg-expfilter"></a></dt>
<dd><p>numeric value for the expression filter level below which
genes are excluded from being markers. Defaults to the level used when
<code><a href="cellMarkers.html">cellMarkers()</a></code> or <code><a href="updateMarkers.html">updateMarkers()</a></code> was called.</p></dd>


<dt id="arg-scheme">scheme<a class="anchor" aria-label="anchor" href="#arg-scheme"></a></dt>
<dd><p>Vector of colours for points.</p></dd>


<dt id="arg-add-labels">add_labels<a class="anchor" aria-label="anchor" href="#arg-add-labels"></a></dt>
<dd><p>character vector of additional genes to label</p></dd>


<dt id="arg-label-pos">label_pos<a class="anchor" aria-label="anchor" href="#arg-label-pos"></a></dt>
<dd><p>character value, either "left" or "right" specifying which
side to add labels. Only for <code>type = 1</code> plots.</p></dd>


<dt id="arg-axis-extend">axis_extend<a class="anchor" aria-label="anchor" href="#arg-axis-extend"></a></dt>
<dd><p>numeric value, specifying how far to extend the x axis to
the left as a proportion. Only invoked when <code>label_pos = "left"</code>.</p></dd>


<dt id="arg-nudge-x-nudge-y">nudge_x, nudge_y<a class="anchor" aria-label="anchor" href="#arg-nudge-x-nudge-y"></a></dt>
<dd><p>Label adjustments passed to <code>geom_label_repel()</code> or
<code>geom_text_repel()</code>.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Optional arguments passed to <code>geom_label_repel()</code> or
<code>geom_text_repel()</code> for <code>specificity_plot()</code> or <code>plot_ly()</code> for
<code>specificity_plotly()</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>ggplot2 or plotly scatter plot object.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>For <code>type = 1</code>, coordinates are drawn as x = angle of vector in degrees, y =
mean gene expression of each gene in the subclass of interest. This version
is easier to use to identify additional gene markers. The plotly version
allows users to hover over points and identify which gene they belong to.</p>
<p>If <code>type = 2</code>, the coordinates are drawn as x = vector length * sin(angle)
and y = vector length * cos(angle), where vector length is the Euclidean
length of that gene in space where each cell subclass is a dimension. Angle
is the angle between the projected vector in space against perfection for
that cell subclass, i.e. the vector lying perfectly along the subclass
dimension with no deviation along other subclass dimensions, i.e. a gene
which is expressed solely in that subclass and has 0 expression in all other
subclasses. y is equal to the mean expression of each gene in the subclass of
interest. x represents the Euclidean distance of mean expression in all other
subclasses, i.e. overall non-specific gene expression in other subclasses.
Thus, the plot represents a rotation of all genes as vectors around the axis
of the subclass of interest onto the same plane so that the angle with the
subclass of interest is visualised between genes.</p>
<p>Colour is used to overlay the ranking of each gene across the subclasses,
showing for each gene where the subclass of interest is ranked compared to
the other subclasses. Best markers have the subclass of interest ranked 1st.</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://github.com/Zaoqu-Liu" class="external-link">Zaoqu Liu</a> and <a href="https://github.com/myles-lewis" class="external-link">Myles Lewis</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

